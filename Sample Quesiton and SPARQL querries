# 1.Object - Location/Footprint:
## 1.1 Where is the "Schlehdorf" gauging station located within the catchment area? [What are the coordinates] - ## Tested and working

PREFIX n4e_hyd: <https://nfdi4earth.pages.rwth-aachen.de/knowledgehub/nfdi4earth-ontology/test_hyd#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX schema: <https://schema.org/>
PREFIX locn: <http://www.w3.org/ns/locn#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
PREFIX sosa: <http://www.w3.org/ns/sosa/>

SELECT ?name ?longitude ?latitude ?altitude
WHERE {
  ?sensor rdf:type sosa:Sensor ;
          schema:name "Bangs" ;
          locn:location ?location .
  
  ?location locn:geometry ?geometry .
  
  ?geometry locn:longitude ?longitude ;
            locn:latitude ?latitude ;
            geo:alt ?altitude .
  
  OPTIONAL {
    ?sensor schema:name ?name .
  }
}



1.2 Where are the gauging stations located within the catchment areas for high annual precipitation in 2015? (maximum 3) - ## Tested and working. 

PREFIX n4e_hyd: <https://nfdi4earth.pages.rwth-aachen.de/knowledgehub/nfdi4earth-ontology/test_hyd#>
PREFIX sosa: <http://www.w3.org/ns/sosa/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX envthes: <http://vocabs.lter-europe.net/EnvThes/>
PREFIX qudt: <https://qudt.org/schema/qudt/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX unit: <https://qudt.org/vocab/unit/>
PREFIX schema: <https://schema.org/>
PREFIX locn: <http://www.w3.org/ns/locn#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>

SELECT ?stationName ?longitude ?latitude (SUM(?precipitation) AS ?totalPrecipitation)
WHERE {
  # Find observations with the observedProperty envthes:30106
  ?observation rdf:type sosa:Observation ;
               sosa:observedProperty envthes:30106 ;
               sosa:madeBySensor ?station ;
               sosa:resultTime ?resultTime ;
               sosa:hasResult ?result .
    
  # Filter for the year 2015
  FILTER (YEAR(?resultTime) = 2015)

  # Access the blank node for QuantityValue
  ?result rdf:type qudt:QuantityValue ;
          qudt:numericValue ?precipitation ;
          qudt:unit unit:MilliM .
      
  # Retrieve gauging station and location details
  ?station rdf:type sosa:Sensor ;
           schema:name ?stationName ;
           locn:location ?location .
    
  ?location locn:geometry ?locationGeometry .
    
  ?locationGeometry locn:longitude ?longitude ;
                    locn:latitude ?latitude ;
                    geo:alt ?altitude .
}

# Group by station to sum precipitation values for each station in 2015
GROUP BY ?stationName ?longitude ?latitude
ORDER BY DESC(?totalPrecipitation)
LIMIT 3


1.3 Where are the largest 5 catchment areas in this dataset?

PREFIX n4e_hyd: <https://nfdi4earth.pages.rwth-aachen.de/knowledgehub/nfdi4earth-ontology/test_hyd#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX envthes: <http://vocabs.lter-europe.net/EnvThes/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX schema: <https://schema.org/>

SELECT ?stationName ?catchment ?catchmentArea ?longitude ?latitude ?altitude

WHERE {
  
    #find the station name 
   ?sensor schema:name ?stationName;
        n4e_hyd:observesArea ?catchment;
        locn:location ?location .
    
  ?location locn:geometry ?locationGeometry .
    
  ?locationGeometry locn:longitude ?longitude ;
                    locn:latitude ?latitude ;
                    geo:alt ?altitude .
    
    
    # Find catchments with area information
  ?catchment rdf:type envthes:30212 ;
             n4e_hyd:catchment_area_calculated ?catchmentArea .
}
ORDER BY DESC(?catchmentArea)
LIMIT 5


3.1 What is the surface area of the largest catchment in the dataset?

PREFIX n4e_hyd: <https://nfdi4earth.pages.rwth-aachen.de/knowledgehub/nfdi4earth-ontology/test_hyd#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX envthes: <http://vocabs.lter-europe.net/EnvThes/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX schema: <https://schema.org/>

PREFIX locn: <http://www.w3.org/ns/locn#>
PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>
SELECT ?stationName ?catchment ?catchmentArea 
WHERE {
  
    #find the station name 
   ?sensor schema:name ?stationName;
        n4e_hyd:observesArea ?catchment.

    
    # Find catchments with area information
  ?catchment rdf:type envthes:30212 ;
             n4e_hyd:catchment_area_calculated ?catchmentArea .
}
ORDER BY DESC(?catchmentArea)
LIMIT 1

3.2 




